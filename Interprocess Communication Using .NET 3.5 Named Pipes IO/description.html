<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Interprocess Communication Using .NET 3.5 Named Pipes IO</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Interprocess Communication Using .NET 3.5 Named Pipes IO</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Windows Forms, WPF, .NET Framework
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Interop, Multithreading, Named Pipe
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">5/6/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Interprocess-Communication-858cc9c7">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><span style="font-size:small">Use the .NET 3.5 Named Pipes IO for Inter-process communication by implementing a pipe listener on a separate thread. The first sample is a WPF project. It can also be done just as easily in Windows forms. By request, I have
 added a VB.NET Windows Forms sample.<br>
</span></p>
<h1><span>Running the Sample</span></h1>
<p><span style="font-size:small">The <strong>PipeClient</strong> and <strong>PipeServer</strong> are two separate projects in the
<strong>NamedPipes</strong> solution sample. Run the <strong>PipeServer.exe</strong>, before sending strings from
<strong>PipeClient</strong></span>.</p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p><span style="font-size:small">The sample demonstrates how to pass string data from clients to a pipe server application that contains a pipe listener that runs on a separate thread within the server application. The main requirement here is that the clients
 are collecting string data and the other application wants to use the string data too, but it needs to collect the information in a background thread.</span></p>
<p><span style="font-size:small">The code snippet below shows the main window class that starts the
<strong>Pipeserve</strong>r thread in the <strong>Window_Loaded</strong> event handler. In Forms, it is the
<strong>Form1_Load</strong> event.<br>
</span></p>
<p><span style="font-size:small">I like to package the thread-owner attributes into a class of all static members. Then it is easy for this class to operate on owner objects.</span></p>
<p><span style="font-size:small">I create an Invoker object for WPF. In Windows Forms this is already implemented for each Form.
</span></p>
<h1><span>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span><span class="hidden">csharp</span>
<pre class="hidden">Imports System
Imports <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.Pipes.aspx"  title="Auto generated link to System.IO.Pipes">System.IO.Pipes</a>
Imports <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Text.aspx"  title="Auto generated link to System.Text">System.Text</a>
Imports <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Threading.aspx"  title="Auto generated link to System.Threading">System.Threading</a>

''' &lt;summary&gt;
''' PipeServer creates a listener thread and waits for messages from clients.
''' Received messages are displayed in Textbox &quot;tbox&quot;
''' &lt;/summary&gt;
''' &lt;remarks&gt;&lt;/remarks&gt;
Public Class Form1
    Private Sub Form1_Load(ByVal sender As Object, _
                           ByVal e As <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>) Handles MyBase.Load
        tbox.Text = &quot;&quot;
        PipeServer.pipeName = &quot;testpipe&quot;
        PipeServer.owner = Me
        Dim pipeThread As ThreadStart = _
                         New ThreadStart(AddressOf PipeServer.createPipeServer)
        Dim listenerThread As Thread = New Thread(pipeThread)
        listenerThread.SetApartmentState(ApartmentState.STA)
        listenerThread.IsBackground = True
        listenerThread.Start()
    End Sub

End Class</pre>
<pre class="hidden">namespace PipeServer
{
  /// &lt;summary&gt;
  /// PipeServer creates a listener thread and waits for messages from clients.
  /// Received messages are displayed in Textbox
  /// &lt;/summary&gt;
  public partial class Window1 : Window
  {
    public Window1()
    {
      InitializeComponent();
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
      tbox.Text = &quot;&quot;;
      Pipeserver.pipeName = &quot;testpipe&quot;;
      Pipeserver.owner = this;
      Pipeserver.ownerInvoker = new Invoker(this);
      ThreadStart pipeThread = new ThreadStart(Pipeserver.createPipeServer);
      Thread listenerThread = new Thread(pipeThread);
      listenerThread.SetApartmentState(ApartmentState.STA);
      listenerThread.IsBackground = true;
      listenerThread.Start();
    }
  }</pre>
<div class="preview">
<pre class="vb"><span class="visualBasic__keyword">Imports</span>&nbsp;System&nbsp;
<span class="visualBasic__keyword">Imports</span>&nbsp;System.IO.Pipes&nbsp;
<span class="visualBasic__keyword">Imports</span>&nbsp;System.Text&nbsp;
<span class="visualBasic__keyword">Imports</span>&nbsp;System.Threading&nbsp;
&nbsp;
<span class="visualBasic__com">'''&nbsp;&lt;summary&gt;</span>&nbsp;
<span class="visualBasic__com">'''&nbsp;PipeServer&nbsp;creates&nbsp;a&nbsp;listener&nbsp;thread&nbsp;and&nbsp;waits&nbsp;for&nbsp;messages&nbsp;from&nbsp;clients.</span>&nbsp;
<span class="visualBasic__com">'''&nbsp;Received&nbsp;messages&nbsp;are&nbsp;displayed&nbsp;in&nbsp;Textbox&nbsp;&quot;tbox&quot;</span>&nbsp;
<span class="visualBasic__com">'''&nbsp;&lt;/summary&gt;</span>&nbsp;
<span class="visualBasic__com">'''&nbsp;&lt;remarks&gt;&lt;/remarks&gt;</span>&nbsp;
<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Class</span>&nbsp;Form1&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;Form1_Load(<span class="visualBasic__keyword">ByVal</span>&nbsp;sender&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Object</span>,&nbsp;_&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">ByVal</span>&nbsp;e&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>)&nbsp;<span class="visualBasic__keyword">Handles</span>&nbsp;<span class="visualBasic__keyword">MyBase</span>.Load&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbox.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PipeServer.pipeName&nbsp;=&nbsp;<span class="visualBasic__string">&quot;testpipe&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PipeServer.owner&nbsp;=&nbsp;<span class="visualBasic__keyword">Me</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;pipeThread&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;ThreadStart&nbsp;=&nbsp;_&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;ThreadStart(<span class="visualBasic__keyword">AddressOf</span>&nbsp;PipeServer.createPipeServer)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;listenerThread&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;Thread&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;Thread(pipeThread)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listenerThread.SetApartmentState(ApartmentState.STA)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listenerThread.IsBackground&nbsp;=&nbsp;<span class="visualBasic__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listenerThread.Start()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Class</span></pre>
</div>
</div>
</div>
</span></h1>
<p><span style="font-size:small"><strong>Pipeserver.createPipeServer</strong> is the static thread method that is attached to the
<strong>pipeThread</strong> delegate. Once the thread starts, </span><span style="font-size:small"><strong>createPipeServer
</strong>runs in a continuous while loop which waits for a connection and processes data coming in on the pipe's stream.</span></p>
<p><span style="font-size:small">The <strong>NamedPipeServerStream</strong> class has a complex set of constructors and properties. I'm using the 6th constructor and setting all the properties in this constructor. Here are the details on the class:
</span><a href="http://msdn.microsoft.com/en-us/library/system.io.pipes.namedpipeserverstream.aspx">http://msdn.microsoft.com/en-us/library/system.io.pipes.namedpipeserverstream.aspx</a></p>
<p><span style="font-size:small"><strong>SetTextbox</strong> is the delegate that gets invoked on the main thread to update Textbox control.</span></p>
<p><span style="font-size:small">I'm using a low-level read hear for flexibility. You could just as well be processing binary data (such as images) with it instead of text.</span></p>
<p><span style="font-size:small">Note that it is important to <strong>Disconnect</strong> the
<strong>PipeServerStream</strong> after processing each incomming message. Otherwise an error will be thrown when the process loops back to wait for the next connection.</span></p>
<p><span style="font-size:small">After all of the bytes are collected as chars in the
<strong>StringBuilder</strong>, the message is posted as a string using the Invoker class. Invoker has an
<strong>Action&lt;string&gt;</strong> delegate (<strong>sDel</strong>) that runs a method delegate that takes a string parameter and is set to
<strong>SetTexbox</strong></span>. <span style="font-size:small">In Windows Forms the
<strong>doSetTextBox </strong>delegate object does the callback to run <strong>SetTexbox</strong> on the owner thread.</span></p>
<h1><span>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span><span class="hidden">csharp</span>
<pre class="hidden">Public Class PipeServer
    Public Shared owner As Form1
    Public Shared pipeName As String
    Private Shared pipeServer As NamedPipeServerStream
    Private Shared ReadOnly BufferSize As Integer = 256

    Delegate Sub SetTextboxDelegate(ByVal text As String)
    Private Shared doSetTextBox As SetTextboxDelegate

    Private Shared Sub SetTextbox(ByVal text As String)
        Dim tb As TextBox = owner.tbox

        tb.Text = String.Concat(tb.Text, text)
        ' Scroll to the bottom of the textbox
        tb.SelectionStart = tb.Text.Length - 2
        tb.ScrollToCaret()
    End Sub

    Public Shared Sub createPipeServer()
        Dim decdr As Decoder = Encoding.Default.GetDecoder()
        Dim bytes(BufferSize) As Byte
        Dim chars(BufferSize) As Char
        Dim numBytes As Integer = 0
        Dim msg As StringBuilder = New StringBuilder()
        doSetTextBox = New SetTextboxDelegate(AddressOf SetTextbox)
        Try
            pipeServer = New NamedPipeServerStream(pipeName, PipeDirection.In, 1, _
                                                   PipeTransmissionMode.Message, _
                                                   PipeOptions.Asynchronous)
            While True
                pipeServer.WaitForConnection()
                Do
                    msg.Length = 0
                    Do
                        numBytes = pipeServer.Read(bytes, 0, BufferSize)
                        If numBytes &gt; 0 Then
                            Dim numChars As Integer = _
                                         decdr.GetCharCount(bytes, 0, numBytes)
                            decdr.GetChars(bytes, 0, numBytes, chars, 0, False)
                            msg.Append(chars, 0, numChars)
                        End If
                    Loop Until (numBytes = 0) Or (pipeServer.IsMessageComplete)
                    decdr.Reset()
                    If numBytes &gt; 0 Then
                        owner.Invoke(doSetTextBox, New Object() {msg.ToString()})
                    End If
                Loop Until numBytes = 0
                pipeServer.Disconnect()
            End While

        Catch ex As Exception
            MessageBox.Show(ex.Message)
        End Try
    End Sub

End Class</pre>
<pre class="hidden">  public class Pipeserver
  {
    public static Window1 owner;
    public static Invoker ownerInvoker;
    public static string pipeName;
    private static NamedPipeServerStream pipeServer;
    private static readonly int BufferSize = 256;

    private static void SetTextbox(String text)
    {
      owner.tbox.Text = String.Concat(owner.tbox.Text, text);
      if (owner.tbox.ExtentHeight &gt; owner.tbox.ViewportHeight)
      {
        owner.tbox.ScrollToEnd();
      }
    }

    public static void createPipeServer()
    {
      Decoder decoder = Encoding.Default.GetDecoder();
      Byte[] bytes = new Byte[BufferSize];
      char[] chars = new char[BufferSize];
      int numBytes = 0;
      StringBuilder msg = new StringBuilder();
      ownerInvoker.sDel = SetTextbox;

      try
      {
        pipeServer = new NamedPipeServerStream(pipeName, PipeDirection.In, 1,
                                               PipeTransmissionMode.Message, 
                                               PipeOptions.Asynchronous);
        while (true)
        {
          pipeServer.WaitForConnection();

          do
          {
            msg.Length = 0;
            do
            {
              numBytes = pipeServer.Read(bytes, 0, BufferSize);
              if (numBytes &gt; 0)
              {
                int numChars = decoder.GetCharCount(bytes, 0, numBytes);
                decoder.GetChars(bytes, 0, numBytes, chars, 0, false);
                msg.Append(chars, 0, numChars);
              }
            } while (numBytes &gt; 0 &amp;&amp; !pipeServer.IsMessageComplete);
            decoder.Reset();
            if (numBytes &gt; 0)
            {
              ownerInvoker.Invoke(msg.ToString());
            }
          } while (numBytes != 0);
          pipeServer.Disconnect();
        }
      }
      catch (Exception ex)
      {
        MessageBox.Show(ex.Message);
      }
    }
  }</pre>
<div class="preview">
<pre class="vb"><span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Class</span>&nbsp;PipeServer&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Shared</span>&nbsp;owner&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;Form1&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Shared</span>&nbsp;pipeName&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;<span class="visualBasic__keyword">Shared</span>&nbsp;pipeServer&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;NamedPipeServerStream&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;<span class="visualBasic__keyword">Shared</span>&nbsp;<span class="visualBasic__keyword">ReadOnly</span>&nbsp;BufferSize&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Integer</span>&nbsp;=&nbsp;<span class="visualBasic__number">256</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Delegate</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;SetTextboxDelegate(<span class="visualBasic__keyword">ByVal</span>&nbsp;text&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;<span class="visualBasic__keyword">Shared</span>&nbsp;doSetTextBox&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;SetTextboxDelegate&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;<span class="visualBasic__keyword">Shared</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;SetTextbox(<span class="visualBasic__keyword">ByVal</span>&nbsp;text&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;tb&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;TextBox&nbsp;=&nbsp;owner.tbox&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb.Text&nbsp;=&nbsp;<span class="visualBasic__keyword">String</span>.Concat(tb.Text,&nbsp;text)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;Scroll&nbsp;to&nbsp;the&nbsp;bottom&nbsp;of&nbsp;the&nbsp;textbox</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb.SelectionStart&nbsp;=&nbsp;tb.Text.Length&nbsp;-&nbsp;<span class="visualBasic__number">2</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb.ScrollToCaret()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Shared</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;createPipeServer()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;decdr&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;Decoder&nbsp;=&nbsp;Encoding.<span class="visualBasic__keyword">Default</span>.GetDecoder()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;bytes(BufferSize)&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Byte</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;chars(BufferSize)&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Char</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;numBytes&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Integer</span>&nbsp;=&nbsp;<span class="visualBasic__number">0</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;msg&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;StringBuilder&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;StringBuilder()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doSetTextBox&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;SetTextboxDelegate(<span class="visualBasic__keyword">AddressOf</span>&nbsp;SetTextbox)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipeServer&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;NamedPipeServerStream(pipeName,&nbsp;PipeDirection.<span class="visualBasic__keyword">In</span>,&nbsp;<span class="visualBasic__number">1</span>,&nbsp;_&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PipeTransmissionMode.Message,&nbsp;_&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PipeOptions.Asynchronous)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">While</span>&nbsp;<span class="visualBasic__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipeServer.WaitForConnection()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Do</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.Length&nbsp;=&nbsp;<span class="visualBasic__number">0</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Do</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numBytes&nbsp;=&nbsp;pipeServer.Read(bytes,&nbsp;<span class="visualBasic__number">0</span>,&nbsp;BufferSize)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;numBytes&nbsp;&gt;&nbsp;<span class="visualBasic__number">0</span>&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;numChars&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Integer</span>&nbsp;=&nbsp;_&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decdr.GetCharCount(bytes,&nbsp;<span class="visualBasic__number">0</span>,&nbsp;numBytes)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decdr.GetChars(bytes,&nbsp;<span class="visualBasic__number">0</span>,&nbsp;numBytes,&nbsp;chars,&nbsp;<span class="visualBasic__number">0</span>,&nbsp;<span class="visualBasic__keyword">False</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.Append(chars,&nbsp;<span class="visualBasic__number">0</span>,&nbsp;numChars)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Loop</span>&nbsp;Until&nbsp;(numBytes&nbsp;=&nbsp;<span class="visualBasic__number">0</span>)&nbsp;<span class="visualBasic__keyword">Or</span>&nbsp;(pipeServer.IsMessageComplete)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decdr.Reset()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;numBytes&nbsp;&gt;&nbsp;<span class="visualBasic__number">0</span>&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owner.Invoke(doSetTextBox,&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;<span class="visualBasic__keyword">Object</span>()&nbsp;{msg.ToString()})&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Loop</span>&nbsp;Until&nbsp;numBytes&nbsp;=&nbsp;<span class="visualBasic__number">0</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipeServer.Disconnect()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">While</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Catch</span>&nbsp;ex&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;Exception&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(ex.Message)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Class</span></pre>
</div>
</div>
</div>
</div>
</span></h1>
<p><span style="font-size:medium"><strong>PipeClient</strong></span></p>
<p><span style="font-size:small">Here is the <strong>button1_Click</strong> code snippet from the client project. All of the work in the demo client is done on the button click. A
<strong>StreamWriter</strong> is simply connected to the <strong>NamedPipeClientStream</strong>, and the contents of the Textblock are written to the pipe stream for each button click.<br>
</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span><span class="hidden">csharp</span>
<pre class="hidden">Imports <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.aspx"  title="Auto generated link to System.IO">System.IO</a>
Imports <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.Pipes.aspx"  title="Auto generated link to System.IO.Pipes">System.IO.Pipes</a>

Public Class Form1

    Private Sub button1_Click(ByVal sender As <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Object.aspx"  title="Auto generated link to System.Object">System.Object</a>, ByVal e As <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>) Handles button1.Click
        Using pipeClient As NamedPipeClientStream = New NamedPipeClientStream(&quot;.&quot;, &quot;testpipe&quot;, _
                                                                        PipeDirection.Out, _
                                                                 PipeOptions.Asynchronous)
            tbStatus.Text = &quot;Attempting to connect to pipe...&quot;
            Try
                pipeClient.Connect(2000)
            Catch ex As Exception
                MessageBox.Show(&quot;The Pipe server must be started in order to send data to it.&quot;)
                Return
            End Try
            tbStatus.Text = &quot;Connected to pipe.&quot;
            Using sw As StreamWriter = New StreamWriter(pipeClient)
                sw.WriteLine(tbClientText.Text)
            End Using
        End Using
        tbStatus.Text = &quot;&quot;
    End Sub

    Private Sub btnClose_Click(ByVal sender As <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Object.aspx"  title="Auto generated link to System.Object">System.Object</a>, ByVal e As <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>) Handles btnClose.Click
        Me.Close()
    End Sub

End Class</pre>
<pre class="hidden">    private void button1_Click(object sender, RoutedEventArgs e)
    {
      using (NamedPipeClientStream pipeClient = new NamedPipeClientStream(&quot;.&quot;, &quot;testpipe&quot;,
                                                                        PipeDirection.Out,
                                                                 PipeOptions.Asynchronous))
      {
        tbStatus.Text = &quot;Attempting to connect to pipe...&quot;;
        try
        {
          pipeClient.Connect(2000);
        }
        catch
        {
          MessageBox.Show(&quot;The Pipe server must be started in order to send data to it.&quot;);
          return;
        }
        tbStatus.Text = &quot;Connected to pipe.&quot;;
        using (StreamWriter sw = new StreamWriter(pipeClient))
        {
          sw.WriteLine(tbClientText.Text);
        }
      }
      tbStatus.Text = &quot;&quot;;
    }</pre>
<div class="preview">
<pre class="vb"><span class="visualBasic__keyword">Imports</span>&nbsp;System.IO&nbsp;
<span class="visualBasic__keyword">Imports</span>&nbsp;System.IO.Pipes&nbsp;
&nbsp;
<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Class</span>&nbsp;Form1&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;button1_Click(<span class="visualBasic__keyword">ByVal</span>&nbsp;sender&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;System.<span class="visualBasic__keyword">Object</span>,&nbsp;<span class="visualBasic__keyword">ByVal</span>&nbsp;e&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>)&nbsp;<span class="visualBasic__keyword">Handles</span>&nbsp;button1.Click&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Using</span>&nbsp;pipeClient&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;NamedPipeClientStream&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;NamedPipeClientStream(<span class="visualBasic__string">&quot;.&quot;</span>,&nbsp;<span class="visualBasic__string">&quot;testpipe&quot;</span>,&nbsp;_&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PipeDirection.Out,&nbsp;_&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PipeOptions.Asynchronous)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbStatus.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;Attempting&nbsp;to&nbsp;connect&nbsp;to&nbsp;pipe...&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pipeClient.Connect(<span class="visualBasic__number">2000</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Catch</span>&nbsp;ex&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;Exception&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(<span class="visualBasic__string">&quot;The&nbsp;Pipe&nbsp;server&nbsp;must&nbsp;be&nbsp;started&nbsp;in&nbsp;order&nbsp;to&nbsp;send&nbsp;data&nbsp;to&nbsp;it.&quot;</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Return</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbStatus.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;Connected&nbsp;to&nbsp;pipe.&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Using</span>&nbsp;sw&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;StreamWriter&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;StreamWriter(pipeClient)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sw.WriteLine(tbClientText.Text)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Using</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Using</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbStatus.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;btnClose_Click(<span class="visualBasic__keyword">ByVal</span>&nbsp;sender&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;System.<span class="visualBasic__keyword">Object</span>,&nbsp;<span class="visualBasic__keyword">ByVal</span>&nbsp;e&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>)&nbsp;<span class="visualBasic__keyword">Handles</span>&nbsp;btnClose.Click&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Me</span>.Close()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Class</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<h1><span>Source Code Files</span></h1>
<p><span><strong><span style="font-size:small">WPF<strong> C# </strong></span></strong><span style="font-size:small">sample</span><br>
</span></p>
<ul>
<li><span style="font-size:small">PipeServer\Windows1.xaml(.cs) - implements the PipeServer app</span><em>&nbsp;</em>
</li><li><span style="font-size:small">PipeClient\Windows1.xaml(.cs) - implements the PipeClient test app</span>
</li></ul>
<p><span style="font-size:small"><strong>Windows Forms VB.NET </strong>sample<strong><br>
</strong></span></p>
<ul>
<li><span style="font-size:small">PipeServer\Form1.vb - implements the PipeServer app</span>
</li><li><span style="font-size:small">PipeClient\Form1.vb - implements the PipeClient test app<br>
</span></li></ul>
<h1>More Information</h1>
<p><span style="font-size:x-small"><strong>NamedPipeServerStream Class</strong> -
</span><a href="http://msdn.microsoft.com/en-us/library/system.io.pipes.namedpipeserverstream.aspx">http://msdn.microsoft.com/en-us/library/system.io.pipes.namedpipeserverstream.aspx</a></p>
<p><strong><span style="color:#000000; font-family:Arial,Helvetica,sans-serif; font-size:x-small; font-style:normal; font-variant:normal; letter-spacing:normal; line-height:normal; orphans:2; text-indent:0px; text-transform:none; white-space:normal; widows:2; word-spacing:0px; background-color:#ffffff; display:inline!important; float:none">NamedPipeClientStream
 Class - </span></strong><a href="http://msdn.microsoft.com/en-us/library/system.io.pipes.namedpipeclientstream.aspx">http://msdn.microsoft.com/en-us/library/system.io.pipes.namedpipeclientstream.aspx</a></p>

</div>


    </div>
</body>
</html>
